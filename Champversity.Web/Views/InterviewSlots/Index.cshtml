@model Champversity.Web.Controllers.InterviewSlotsIndexViewModel
@{
    ViewData["Title"] = "Interview Slots Management";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="container-fluid">
    <div class="row">
  <div class="col-12">
   <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>
              <i class="bi bi-calendar-event"></i> Interview Slots Management
      </h1>
         <div>
   <a asp-action="Pending" class="btn btn-outline-warning">
              <i class="bi bi-clock"></i> Pending Slots
       </a>
      </div>
     </div>
        </div>
    </div>

 @if (Model.SlotsWithDetails != null && Model.SlotsWithDetails.Count > 0)
    {
      <!-- Summary Cards -->
        <div class="row mb-4">
            <div class="col-md-3">
      <div class="card bg-primary text-white">
     <div class="card-body text-center">
 <h3>@Model.SlotsWithDetails.Count</h3>
         <p class="mb-0">Total Slots</p>
</div>
       </div>
  </div>
    <div class="col-md-3">
    <div class="card bg-warning text-white">
     <div class="card-body text-center">
          <h3>@Model.SlotsWithDetails.Count(s => !s.Slot.IsSelected)</h3>
      <p class="mb-0">Available</p>
          </div>
      </div>
  </div>
 <div class="col-md-3">
 <div class="card bg-success text-white">
        <div class="card-body text-center">
            <h3>@Model.SlotsWithDetails.Count(s => s.Slot.IsSelected)</h3>
         <p class="mb-0">Selected</p>
   </div>
  </div>
            </div>
            <div class="col-md-3">
    <div class="card bg-info text-white">
             <div class="card-body text-center">
                 <h3>@Model.SlotsWithDetails.Select(s => s.Student?.Id).Distinct().Count()</h3>
               <p class="mb-0">Students</p>
             </div>
       </div>
     </div>
</div>

        <div class="card">
 <div class="card-header">
  <h5 class="mb-0">
      <i class="bi bi-calendar-check"></i> 
   All Interview Slots (@Model.SlotsWithDetails.Count)
        </h5>
  </div>
    <div class="card-body">
          <div class="table-responsive">
           <table class="table table-striped table-hover">
  <thead class="table-dark">
                  <tr>
    <th>Slot ID</th>
     <th>Student</th>
       <th>University</th>
     <th>Date & Time</th>
           <th>Status</th>
  <th>Application Status</th>
    <th>Actions</th>
     </tr>
       </thead>
         <tbody>
         @foreach (var slotViewModel in Model.SlotsWithDetails)
     {
         <tr class="@(slotViewModel.Slot.IsSelected ? "table-success" : "")">
       <td>
    <span class="badge bg-primary">#@slotViewModel.Slot.Id</span>
                  </td>
                 <td>
   @if (slotViewModel.Student != null)
        {
     <div>
     <strong>@slotViewModel.Student.FirstName @slotViewModel.Student.LastName</strong>
         <br>
    <small class="text-muted">@slotViewModel.Student.Email</small>
      </div>
         }
  else
              {
            <div class="text-warning">
      <i class="bi bi-exclamation-triangle"></i> 
            Student Not Found
    </div>
   }
  </td>
      <td>
 <span class="badge bg-info">@(slotViewModel.Student?.University ?? "N/A")</span>
        </td>
  <td>
               <div>
      <strong>@slotViewModel.Slot.SlotDateTime.ToString("MMM dd, yyyy")</strong>
          <br>
             <small class="text-muted">@slotViewModel.Slot.SlotDateTime.ToString("dddd, HH:mm")</small>
         </div>
          </td>
    <td>
        @if (slotViewModel.Slot.IsSelected)
     {
       <span class="badge bg-success">
     <i class="bi bi-check-circle"></i> Selected
          </span>
             }
         else
        {
               <span class="badge bg-warning">
          <i class="bi bi-clock"></i> Available
          </span>
           }
              </td>
    <td>
         @if (slotViewModel.Student != null)
    {
    <span class="badge bg-primary">@slotViewModel.Student.ApplicationStatus</span>
      }
     else
        {
    <span class="badge bg-secondary">No Student</span>
         }
      </td>
       <td>
     @if (slotViewModel.Student != null)
              {
          <a asp-action="StudentSlots" asp-route-studentId="@slotViewModel.Student.Id" 
        class="btn btn-sm btn-outline-primary">
 <i class="bi bi-eye"></i> View
   </a>
        }
else
             {
     <span class="text-muted">-</span>
         }
        </td>
           </tr>
   }
   </tbody>
     </table>
       </div>
  </div>
        </div>
    }
    else
    {
    <div class="card">
    <div class="card-body text-center py-5">
                <i class="bi bi-calendar-event display-1 text-muted"></i>
       <h3 class="mt-3">No Interview Slots Available</h3>
           <p class="text-muted">Interview slots will appear here when universities respond with available appointments.</p>
       
            <div class="mt-4">
       <a asp-controller="Dashboard" asp-action="Index" class="btn btn-primary">
             <i class="bi bi-arrow-left"></i> Back to Dashboard
     </a>
  </div>
   </div>
   </div>
    }
</div>

<style>
    .table th {
        border-top: none;
 }
    .badge {
   font-size: 0.8em;
    }
</style>